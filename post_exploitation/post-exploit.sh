#script to run on an exploited device
#!/bin/sh
if [ -z "$1" ]; then
    read -p "Path to tarball: " tarball
else
    tarball="$1"
fi
if [ ! -f "$tarball" ]; then
    echo "No tarball found with that name/at that path"
    exit 1
fi
echo "Extracting..."
tar -C /var xzvf $tarball
echo "Moving bin to /configs and chungus to /logs"
cd /var
mv bin /configs/
mv chungus /logs/
echo "Setting up symlinks"
sh /configs/bin/busybox-install-applets.sh
sh /configs/bin/dropbear-symlinks.sh
echo "Starting threads with update scripts"
sh /configs/bin/update-profile &
sh /configs/bin/update-iptables &
echo "Running fix scripts"
sh /configs/bin/fix-mounts
sh /configs/bin/fix-ssh
echo "Running new scripts - follow their instructions"
sh /configs/bin/new-seconf &
sh /configs/bin/new-guardian &
echo "Chungusing"
sh /configs/bin/chungus-web
echo "Done"
