#usage: ./decrypt-all.sh 192.168.1.254.xml
#!/bin/bash
red='\033[0;31m'
green='\033[0;32m'
yellow='\033[0;33m'
clear='\033[0m'
if [ -z "$1" ]; then
	printf "XML file to strip passwords from: "
	read filename
else
    filename="$1"
fi
if [ -z "$filename" ]; then
    echo "File not found."
    exit 1
fi
strip_passwords () {
grep -ai password $filename  | grep -aoE "v=\"[A-Z,a-z,0-9,\/\=\+\%]{2,}" | cut -c 4- | sort -u
}
passwords="$(strip_passwords | sed 's/\ \ /\ /g')"
for P in $passwords; do
    printf "String: \n${yellow}"
    grep -a -m1 $P $filename | grep -aoE "</[A-Z,a-z,0-9,\_\-\=\+\%\/]{3,}>" | cut -c 3- | rev | cut -c 2- | rev
    printf "${clear}Value: \n${green}"
    printf "$P \n"
    printf "${clear}"
    done
